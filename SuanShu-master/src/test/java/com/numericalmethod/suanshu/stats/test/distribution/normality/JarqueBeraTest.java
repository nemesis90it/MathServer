/*
 * Copyright (c) Numerical Method Inc.
 * http://www.numericalmethod.com/
 * 
 * THIS SOFTWARE IS LICENSED, NOT SOLD.
 * 
 * YOU MAY USE THIS SOFTWARE ONLY AS DESCRIBED IN THE LICENSE.
 * IF YOU ARE NOT AWARE OF AND/OR DO NOT AGREE TO THE TERMS OF THE LICENSE,
 * DO NOT USE THIS SOFTWARE.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITH NO WARRANTY WHATSOEVER,
 * EITHER EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION,
 * ANY WARRANTIES OF ACCURACY, ACCESSIBILITY, COMPLETENESS,
 * FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, NON-INFRINGEMENT, 
 * TITLE AND USEFULNESS.
 * 
 * IN NO EVENT AND UNDER NO LEGAL THEORY,
 * WHETHER IN ACTION, CONTRACT, NEGLIGENCE, TORT, OR OTHERWISE,
 * SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
 * ANY CLAIMS, DAMAGES OR OTHER LIABILITIES,
 * ARISING AS A RESULT OF USING OR OTHER DEALINGS IN THE SOFTWARE.
 */
package com.numericalmethod.suanshu.stats.test.distribution.normality;

import org.junit.Test;
import static org.junit.Assert.*;

/**
 *
 * @author Haksun Li
 */
public class JarqueBeraTest {

    /**
    library(tseries)
    x=c(39, 35, 33, 33, 32, 30, 30, 30, 28, 28,
    27, 27, 27, 27, 27, 26, 26, 26, 26, 26,
    26, 25, 25, 25, 25, 25, 25, 24, 24, 24,
    24, 24, 23, 23, 23, 23, 23, 23, 23, 23,
    23, 23, 23, 23, 23, 22, 22, 22, 22, 21,
    21, 21, 21, 21, 21, 21, 20, 20, 19, 19,
    18, 16)
    jarque.bera.test(x)
     */
    @Test
    public void testNullHypothesis() {
        double[] samples = new double[]{
            39, 35, 33, 33, 32, 30, 30, 30, 28, 28,
            27, 27, 27, 27, 27, 26, 26, 26, 26, 26,
            26, 25, 25, 25, 25, 25, 25, 24, 24, 24,
            24, 24, 23, 23, 23, 23, 23, 23, 23, 23,
            23, 23, 23, 23, 23, 22, 22, 22, 22, 21,
            21, 21, 21, 21, 21, 21, 20, 20, 19, 19,
            18, 16
        };

        JarqueBera instance = new JarqueBera(samples, false);
        assertEquals(18.9572, instance.statistics(), 1e-4);
        assertEquals(7.647e-05, instance.pValue(), 1e-4);
    }

    /**
    library(tseries)
    x=c( -0.220439976089493311, -0.901223037841532792, -0.685251570093702855, 1.355423886140093348, -0.302730402454707059, 0.564794962797818600,
    -1.708717279704368375, 0.207860154236674310, 0.622189153879543211, -1.262915951837922268, 1.957066708840941249, 1.023307129663016735,
    0.389238654573311083, -1.198098980239177935, -0.386944339745704136, 1.147819062152708680, 0.518947196710519143, 0.279480397968551286,
    0.666811214933503149, -1.495945652189867747, -2.456480840811176236, -1.058233621631058385, 0.544139884378790240, -2.108213997718507926,
    -0.762833960429111557, -1.264638897497770476, -0.536892566411792393, -0.242846094505169446, 1.003659847810750128, -0.494788106086618384,
    -0.392155020887315908, -0.774254555234437536, 0.627005611811510710, 0.281520099412424063, -1.405224119788718529, -1.167965499712645183,
    1.141462423798735637, 0.787681581107052997, 0.293924495714060707, -0.710303969997825413, 0.519401444264388612, 0.304888383295780108,
    0.694463199066772119, -0.387629719650456284, -1.941055208333497095, -0.285376416232774599, -1.207128554182654856, 3.152793825546431172,
    1.218640353646994301, 0.451740823061492047, 0.097900222458156480, -0.595133665172100645, 0.070508782522807914, 0.055497875597647676,
    1.026823960634534627, 0.938909849146218778, -0.812562260925464241, 0.685780983918828024, 1.409764210838367671, 0.225892248966642617,
    -1.018593009130992266, -0.565247792594771092, -1.324259124364043805, 0.056424203364331273, 0.159625334522376539, -1.157879177840001050,
    1.534673121025832643, 1.365487406848891805, 1.394271757902017184, -1.074053122251962478, 0.244600794747516809, -0.665251821000177657,
    -2.127406411093351490, -0.989750108500854098, -0.767721342707781695, -1.107234019979404849, -0.090643899907038750, 0.253874613507434288,
    -0.110402323690669921, -0.952305882455832475, -1.195024774415174296, 0.554123047521937195, 0.131354286318139557, 0.723505571998101171,
    0.526374236078826274, -1.214139259838247664, -1.983624639071787543, 0.372535246511344065, 1.290018948537765109, 0.843255354526367795,
    0.246067596981827591, -1.472454881686079631, -0.414055854746928964, -0.585731338329817608, -0.167464479298495922, 0.003328577439349216,
    -0.234718648639474364, -2.359786723512646844, 0.464521030335880658, 1.165517234306393535)
    jarque.bera.test(x)
     */
    @Test
    public void test_0020() {
        double[] samples = new double[]{
            -0.220439976089493311, -0.901223037841532792, -0.685251570093702855, 1.355423886140093348, -0.302730402454707059, 0.564794962797818600,
            -1.708717279704368375, 0.207860154236674310, 0.622189153879543211, -1.262915951837922268, 1.957066708840941249, 1.023307129663016735,
            0.389238654573311083, -1.198098980239177935, -0.386944339745704136, 1.147819062152708680, 0.518947196710519143, 0.279480397968551286,
            0.666811214933503149, -1.495945652189867747, -2.456480840811176236, -1.058233621631058385, 0.544139884378790240, -2.108213997718507926,
            -0.762833960429111557, -1.264638897497770476, -0.536892566411792393, -0.242846094505169446, 1.003659847810750128, -0.494788106086618384,
            -0.392155020887315908, -0.774254555234437536, 0.627005611811510710, 0.281520099412424063, -1.405224119788718529, -1.167965499712645183,
            1.141462423798735637, 0.787681581107052997, 0.293924495714060707, -0.710303969997825413, 0.519401444264388612, 0.304888383295780108,
            0.694463199066772119, -0.387629719650456284, -1.941055208333497095, -0.285376416232774599, -1.207128554182654856, 3.152793825546431172,
            1.218640353646994301, 0.451740823061492047, 0.097900222458156480, -0.595133665172100645, 0.070508782522807914, 0.055497875597647676,
            1.026823960634534627, 0.938909849146218778, -0.812562260925464241, 0.685780983918828024, 1.409764210838367671, 0.225892248966642617,
            -1.018593009130992266, -0.565247792594771092, -1.324259124364043805, 0.056424203364331273, 0.159625334522376539, -1.157879177840001050,
            1.534673121025832643, 1.365487406848891805, 1.394271757902017184, -1.074053122251962478, 0.244600794747516809, -0.665251821000177657,
            -2.127406411093351490, -0.989750108500854098, -0.767721342707781695, -1.107234019979404849, -0.090643899907038750, 0.253874613507434288,
            -0.110402323690669921, -0.952305882455832475, -1.195024774415174296, 0.554123047521937195, 0.131354286318139557, 0.723505571998101171,
            0.526374236078826274, -1.214139259838247664, -1.983624639071787543, 0.372535246511344065, 1.290018948537765109, 0.843255354526367795,
            0.246067596981827591, -1.472454881686079631, -0.414055854746928964, -0.585731338329817608, -0.167464479298495922, 0.003328577439349216,
            -0.234718648639474364, -2.359786723512646844, 0.464521030335880658, 1.165517234306393535
        };

        JarqueBera instance = new JarqueBera(samples, false);
        assertEquals(0.0516, instance.statistics(), 1e-4);
        assertEquals(0.9745, instance.pValue(), 1e-4);
    }
}
